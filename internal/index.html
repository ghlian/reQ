<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://jmcmurray.co.uk/reQ/internal/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Internal Functions - reQ</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-119708613-1', 'jmcmurray.co.uk');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="..">reQ</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="..">Overview</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Features <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../features/cookies/">Cookies</a>
</li>
                                    
<li >
    <a href="../features/headers/">Headers</a>
</li>
                                    
<li >
    <a href="../features/redirects/">HTTP redirects</a>
</li>
                                    
<li >
    <a href="../features/verbose/">Verbose mode</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">API <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../api/md/public/">Public functions</a>
</li>
                                    
<li >
    <a href="../api/md/private/">Private functions</a>
</li>
                                    
<li >
    <a href="../api/md/variable/">Variables</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../examples/aoc/">Advent of Code</a>
</li>
                                    
<li >
    <a href="../examples/github/">GitHub</a>
</li>
                                    
<li >
    <a href="../examples/jira/">JIRA</a>
</li>
                                    
<li >
    <a href="../examples/zoho/">Zoho</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li>
                                <a href="https://github.com/jonathonmcmurray/reQ/edit/master/docs/internal.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#internal-functions">Internal Functions</a></li>
            <li><a href="#reqaddcookie">.req.addcookie</a></li>
            <li><a href="#reqgetcookies">.req.getcookies</a></li>
            <li><a href="#reqreadjar">.req.readjar</a></li>
            <li><a href="#reqwritejar">.req.writejar</a></li>
            <li><a href="#reqsturl">.req.sturl</a></li>
            <li><a href="#reqhsurl">.req.hsurl</a></li>
            <li><a href="#reqhap">.req.hap</a></li>
            <li><a href="#reqprot">.req.prot</a></li>
            <li><a href="#requser">.req.user</a></li>
            <li><a href="#reqhost">.req.host</a></li>
            <li><a href="#reqendp">.req.endp</a></li>
            <li><a href="#reqb64encode">.req.b64encode</a></li>
            <li><a href="#reqb64decode">.req.b64decode</a></li>
            <li><a href="#reqty">.req.ty</a></li>
            <li><a href="#reqhu">.req.hu</a></li>
            <li><a href="#reqproxy">.req.proxy</a></li>
            <li><a href="#reqheaders">.req.headers</a></li>
            <li><a href="#reqenchd">.req.enchd</a></li>
            <li><a href="#reqbuildquery">.req.buildquery</a></li>
            <li><a href="#reqformatresp">.req.formatresp</a></li>
            <li><a href="#requrlencode">.req.urlencode</a></li>
            <li><a href="#requrldecode">.req.urldecode</a></li>
            <li><a href="#reqokstatus">.req.okstatus</a></li>
            <li><a href="#reqsend">.req.send</a></li>
            <li><a href="#reqparseresp">.req.parseresp</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="internal-functions">Internal Functions</h1>
<p><em>Warning: The functions documented here are internal functions used by the
library. While most of these are unlikely to change in usage in future versions
be aware this is possible and take care if using these functions directly</em></p>
<p>Below is preliminary documentation of internal functions, more detail will be
added in time.</p>
<hr />
<h4 id="reqaddcookie"><code>.req.addcookie</code></h4>
<p><code>[host;cookiestring]</code></p>
<p>The function called internally when a <code>Set-Cookie</code> header is received on an
HTTP response, taking the host for the request &amp; the cookie header string as
arguments.</p>
<pre><code>q).req.addcookie[&quot;adventofcode.com&quot;;&quot;session=n0tar34ls3ss10nc00k13&quot;]
q).req.cookiejar
host               path name     | val                     expires maxage secure httponly samesite
---------------------------------| ---------------------------------------------------------------
&quot;adventofcode.com&quot; ,&quot;*&quot; &quot;session&quot;| &quot;n0tar34ls3ss10nc00k13&quot;                0      0
</code></pre>

<h4 id="reqgetcookies"><code>.req.getcookies</code></h4>
<p><code>[protocol;host;path]</code></p>
<p>Get applicable cookies from cookiejar for given protocol, host &amp; path</p>
<h4 id="reqreadjar"><code>.req.readjar</code></h4>
<p><code>[file]</code></p>
<p>Read cURL/Netscape format cookiejar into reQ internal cookiejar format</p>
<p>use <code>`.req.cookiejar upsert .req.readjar[`:file]</code> to update internal jar</p>
<h4 id="reqwritejar"><code>.req.writejar</code></h4>
<p><code>[file;jar]</code></p>
<p>Write internal reQ cookiejar to file in cURL/Netscape format</p>
<h4 id="reqsturl"><code>.req.sturl</code></h4>
<p><code>[url]</code></p>
<p>Get string form of URL, given symbol, hsym or string</p>
<h4 id="reqhsurl"><code>.req.hsurl</code></h4>
<p><code>[url]</code></p>
<p>Get hsym form of URL, given symbol, hsym or string</p>
<h4 id="reqhap"><code>.req.hap</code></h4>
<p><code>[url]</code></p>
<p>Split URL into protocol, username:pass, domain &amp; path. Accept string, hsym or
symbol.</p>
<h4 id="reqprot"><code>.req.prot</code></h4>
<p><code>[url]</code></p>
<p>Extract protocol from URL</p>
<h4 id="requser"><code>.req.user</code></h4>
<p><code>[url]</code></p>
<p>Extract username:pass from URL</p>
<h4 id="reqhost"><code>.req.host</code></h4>
<p><code>[url]</code></p>
<p>Extract domain from URL</p>
<h4 id="reqendp"><code>.req.endp</code></h4>
<p><code>[url]</code></p>
<p>Extract endpoint/path from URL</p>
<h4 id="reqb64encode"><code>.req.b64encode</code></h4>
<p><code>[string]</code></p>
<p>base64 encode a string (e.g. for HTTP Basic Authentication)</p>
<h4 id="reqb64decode"><code>.req.b64decode</code></h4>
<p><code>[string]</code></p>
<p>base64 decode a string</p>
<h4 id="reqty"><code>.req.ty</code></h4>
<p>Extended version of <code>.h.ty</code> dictionary mapping <code>Content-Type</code> strings to
simple symbols</p>
<h4 id="reqhu"><code>.req.hu</code></h4>
<p><code>[string]</code></p>
<p>Escape URI non-safe characters, based on RFC-3986 (more updated spec than <code>.h.hu</code>)</p>
<h4 id="reqproxy"><code>.req.proxy</code></h4>
<p><code>[host]</code></p>
<p>Check if proxy is required for given host</p>
<h4 id="reqheaders"><code>.req.headers</code></h4>
<p><code>[username;proxy;headers;payload]</code></p>
<p>Generate HTTP headers from combination of defaults &amp; custom headers, adding
proxy headers if necessary &amp; <code>Content-Length</code> for payload</p>
<h4 id="reqenchd"><code>.req.enchd</code></h4>
<p><code>[headers]</code></p>
<p>Convert a kdb dictionary to HTTP headers</p>
<h4 id="reqbuildquery"><code>.req.buildquery</code></h4>
<p><code>[method;proxy;url;host;headers;payload]</code></p>
<p>Build HTTP query string including necessary headers etc.</p>
<h4 id="reqformatresp"><code>.req.formatresp</code></h4>
<p><code>[response]</code></p>
<p>Split HTTP response into header dictionary &amp; body</p>
<h4 id="requrlencode"><code>.req.urlencode</code></h4>
<p><code>[dict]</code></p>
<p>Convert a kdb dictionary to a URL encoded string</p>
<h4 id="requrldecode"><code>.req.urldecode</code></h4>
<p><code>[string]</code></p>
<p>Convert a URL encoded string to a kdb dictionary</p>
<h4 id="reqokstatus"><code>.req.okstatus</code></h4>
<p><code>[verbose;response]</code></p>
<p>Check status of response &amp; signal if bad</p>
<h4 id="reqsend"><code>.req.send</code></h4>
<p><code>[method;url;headers;payload;verbose]</code></p>
<p>Entry point for sending any type of HTTP request</p>
<h4 id="reqparseresp"><code>.req.parseresp</code></h4>
<p><code>[resp]</code></p>
<p>If response has <code>Content-Type: application/json</code>, parse to kdb object. (Other
formats may be added in future)</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"search": 83, "help": 191, "next": 78, "previous": 80};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
